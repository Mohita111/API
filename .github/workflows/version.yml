name: Version Documentation

on:
  push:
    branches:
      - main  # Runs when changes are pushed to main

jobs:
  create_version:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Auto Increment Version
        id: version
        run: |
          LAST_VERSION=$(git tag --sort=-v:refname | head -n 1 || echo "v0.0.0")
          NEW_VERSION=$(echo $LAST_VERSION | awk -F. -v OFS=. '{$NF += 1 ; print}')
          echo "NEW_VERSION=$NEW_VERSION" >> $GITHUB_ENV
          echo "Next Version: $NEW_VERSION"

      - name: Create Git Tag
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"
          git tag $NEW_VERSION
          git push origin $NEW_VERSION

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: ${{ env.NEW_VERSION }}
          name: "Version ${{ env.NEW_VERSION }}"
          body: "New documentation update."
          draft: false
          prerelease: false
